<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-terminal-4.7.0">
    
    <meta name="description" content="Documentation for the Floxide framework - A type-safe, composable directed graph workflow system written in Rust"> 
    
    <meta name="author" content="Floxide Team"> 
    <link rel="icon" type="image/png" sizes="192x192" href="../../img/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="../../img/android-chrome-512x512.png" />
<link rel="apple-touch-icon" sizes="180x180" href="../../img/apple-touch-icon.png" />
<link rel="shortcut icon" type="image/png" sizes="48x48" href="../../img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="../../img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="../../img/favicon-32x32.png" />


    
 
<title>Batch Processing Implementation - Floxide Documentation</title>


<link href="../../css/fontawesome/css/fontawesome.min.css" rel="stylesheet">
<link href="../../css/fontawesome/css/solid.min.css" rel="stylesheet">
<link href="../../css/normalize.css" rel="stylesheet">
<link href="../../css/terminal.css" rel="stylesheet">
<link href="../../css/theme.css" rel="stylesheet">
<link href="../../css/theme.tile_grid.css" rel="stylesheet">
<link href="../../css/theme.footer.css" rel="stylesheet">
<!-- dark color palette -->
<link href="../../css/palettes/dark.css" rel="stylesheet">

<!-- page layout -->
<style>
/* initially set page layout to a one column grid */
.terminal-mkdocs-main-grid {
    display: grid;
    grid-column-gap: 1.4em;
    grid-template-columns: auto;
    grid-template-rows: auto;
}

/*  
*   when side navigation is not hidden, use a two column grid.  
*   if the screen is too narrow, fall back to the initial one column grid layout.
*   in this case the main content will be placed under the navigation panel. 
*/
@media only screen and (min-width: 70em) {
    .terminal-mkdocs-main-grid {
        grid-template-columns: 4fr 9fr;
    }
}</style>



    
    <link href="../../css/extra.css" rel="stylesheet">  
    
    

    
    <!-- search css support -->
<link href="../../css/search/bootstrap-modal.css" rel="stylesheet">
<!-- search scripts -->
<script>
    var base_url = "../..",
    shortcuts = "{}";
</script>
<script src="../../js/jquery/jquery-1.10.1.min.js" defer></script>
<script src="../../js/bootstrap/bootstrap.min.js" defer></script>
<script src="../../js/mkdocs/base.js" defer></script>
    
    
    
    
    <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <script src="../../search/main.js"></script>
    

    
</head>

<body class="terminal"><div class="container">
    <div class="terminal-nav">
        <header class="terminal-logo">
            <div id="mkdocs-terminal-site-name" class="logo terminal-prompt"><a href="/" class="no-style">Floxide Documentation</a></div>
        </header>
        
        <nav class="terminal-menu">
            
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                
                <li property="itemListElement" typeof="ListItem">
                    <a href="../.." class="menu-item " property="item" typeof="WebPage">
                        <span property="name">Home</span>
                    </a>
                    <meta property="position" content="0">
                </li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li property="itemListElement" typeof="ListItem">
                    <a href="../../contributing/" class="menu-item " property="item" typeof="WebPage">
                        <span property="name">Contributing</span>
                    </a>
                    <meta property="position" content="1">
                </li>
                
                    
                    


<li property="itemListElement" typeof="ListItem">
    <a href="#" class="menu-item" data-toggle="modal" data-target="#mkdocs_search_modal" property="item" typeof="SearchAction">
        <i aria-hidden="true" class="fa fa-search"></i> <span property="name">Search</span>
    </a>
    <meta property="position" content="2">
</li>
                    
            </ul>
            
        </nav>
    </div>
</div>
        
    <div class="container">
        <div class="terminal-mkdocs-main-grid"><aside id="terminal-mkdocs-side-panel"><nav>
  
    <ul class="terminal-mkdocs-side-nav-items">
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../..">Home</a>
        
    
    
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        

        
            
    
        
        
            
            
            <span class="
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Getting Started</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../getting-started/installation/">Installation</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../getting-started/quick-start/">Quick Start</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../getting-started/error-handling/">Error Handling</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        

        
            
    
        
        
            
            
            <span class="
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Core Concepts</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../core-concepts/overview/">Overview</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../core-concepts/nodes/">Nodes</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../core-concepts/workflows/">Workflows</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../core-concepts/actions/">Actions</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../core-concepts/contexts/">Contexts</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        

        
            
    
        
        
            
            
            <span class="
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Guides</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../guides/event_driven_architecture/">Event-Driven Architecture</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../guides/using-mermaid-diagrams/">Using Mermaid Diagrams</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        

        
            
    
        
        
            
            
            <span class="
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Examples</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../examples/basic-workflow/">Basic Workflow</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../examples/event-driven-workflow/">Event-Driven Workflow</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../examples/timer-node/">Timer Node</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../examples/reactive-node/">Reactive Node</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../examples/transform-node/">Transform Node</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../examples/longrunning-node/">Long-Running Node</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../examples/batch-processing/">Batch Processing</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        

        
            
    
        
        <span class="
        
    

    terminal-mkdocs-side-nav-item--active terminal-mkdocs-side-nav-section-no-index">Architecture</span>
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../adr-process/">ADR Process</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../core-framework-abstractions/">Core Framework Abstractions</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../project-structure/">Project Structure</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../async-runtime-selection/">Async Runtime Selection</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../node-lifecycle-methods/">Node Lifecycle Methods</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../event-driven-workflow-pattern/">Event-Driven Workflow Pattern</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../reactive-node-implementation/">Reactive Node Implementation</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../timer-node-implementation/">Timer Node Implementation</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../longrunning-node-implementation/">Long-Running Node Implementation</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../transform-node-implementation/">Transform Node Implementation</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        <span class="

    terminal-mkdocs-side-nav-item--active">Batch Processing Implementation</span>
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        

        
            
    
        
        
            
            
            <span class="
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">API Reference</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../api/floxide-core/">floxide-core</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../api/floxide-transform/">floxide-transform</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../api/floxide-event/">floxide-event</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../api/floxide-timer/">floxide-timer</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../api/floxide-reactive/">floxide-reactive</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../api/floxide-longrunning/">floxide-longrunning</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../api/floxide-batch/">floxide-batch</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../../contributing/">Contributing</a>
        
    
    
    
  </li>
        
    </ul>
  
</nav><hr>
<nav>
    <ul>
        <li><a href="#batch-processing-implementation">Batch Processing Implementation</a></li>
        <li><a href="#overview">Overview</a></li><li><a href="#core-concepts">Core Concepts</a></li><li><a href="#batchcontext">BatchContext</a></li><li><a href="#batchnode">BatchNode</a></li><li><a href="#batchprocessor">BatchProcessor</a></li><li><a href="#batchflow">BatchFlow</a></li><li><a href="#usage-example">Usage Example</a></li><li><a href="#conclusion">Conclusion</a></li>
    </ul>
</nav>
</aside>
            <main id="terminal-mkdocs-main-content">
<section id="mkdocs-terminal-content">
    <h1 id="batch-processing-implementation">Batch Processing Implementation<a class="headerlink" href="#batch-processing-implementation" title="Permanent link">&para;</a></h1>
<p>This document describes the batch processing implementation in the Floxide framework.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Batch processing in the Floxide framework enables efficient parallel execution of workflows on collections of items. This capability is essential for handling large datasets and maximizing throughput in workflow applications.</p>
<h2 id="core-concepts">Core Concepts<a class="headerlink" href="#core-concepts" title="Permanent link">&para;</a></h2>
<p>The batch processing implementation is built around several key concepts:</p>
<ol>
<li><strong>BatchContext</strong>: A specialized context that manages collections of items</li>
<li><strong>BatchNode</strong>: A node that can process items in parallel</li>
<li><strong>BatchFlow</strong>: A workflow orchestrator for batch processing</li>
</ol>
<h2 id="batchcontext">BatchContext<a class="headerlink" href="#batchcontext" title="Permanent link">&para;</a></h2>
<p>The <code>BatchContext</code> trait defines how contexts that support batch operations should behave:</p>
<div class="language-rust highlight"><pre><span></span><code><span id="__span-0-1"><span class="sd">/// Trait for contexts that support batch processing</span>
</span><span id="__span-0-2"><span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">BatchContext</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-3"><span class="w">    </span><span class="sd">/// Get the items to process in batch</span>
</span><span id="__span-0-4"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">get_batch_items</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span><span class="p">;</span>
</span><span id="__span-0-5">
</span><span id="__span-0-6"><span class="w">    </span><span class="sd">/// Create a context for a single item</span>
</span><span id="__span-0-7"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">create_item_context</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="nc">T</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="bp">Self</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="bp">Self</span><span class="p">:</span><span class="w"> </span><span class="nb">Sized</span><span class="p">;</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="w">    </span><span class="sd">/// Update the main context with results from item processing</span>
</span><span id="__span-0-10"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">update_with_results</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span><span class="p">;</span>
</span><span id="__span-0-11"><span class="p">}</span>
</span></code></pre></div>
<p>A concrete implementation of <code>BatchContext</code> typically wraps a standard context and adds batch-specific functionality:</p>
<div class="language-rust highlight"><pre><span></span><code><span id="__span-1-1"><span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">SimpleBatchContext</span><span class="o">&lt;</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><span class="w">    </span><span class="n">inner_context</span><span class="p">:</span><span class="w"> </span><span class="nc">Context</span><span class="o">&lt;</span><span class="n">S</span><span class="o">&gt;</span><span class="p">,</span>
</span><span id="__span-1-3"><span class="w">    </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span>
</span><span id="__span-1-4"><span class="w">    </span><span class="n">results</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;&gt;</span><span class="p">,</span>
</span><span id="__span-1-5"><span class="p">}</span>
</span><span id="__span-1-6">
</span><span id="__span-1-7"><span class="k">impl</span><span class="o">&lt;</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">BatchContext</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SimpleBatchContext</span><span class="o">&lt;</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span>
</span><span id="__span-1-8"><span class="k">where</span>
</span><span id="__span-1-9"><span class="w">    </span><span class="n">S</span><span class="p">:</span><span class="w"> </span><span class="nb">Clone</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Send</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">&#39;</span><span class="nb">static</span><span class="p">,</span>
</span><span id="__span-1-10"><span class="w">    </span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="nb">Clone</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Send</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">&#39;</span><span class="nb">static</span><span class="p">,</span>
</span><span id="__span-1-11"><span class="p">{</span>
</span><span id="__span-1-12"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">get_batch_items</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-13"><span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">clone</span><span class="p">())</span>
</span><span id="__span-1-14"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-15">
</span><span id="__span-1-16"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">create_item_context</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="nc">T</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="bp">Self</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-17"><span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">SimpleBatchContext</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-18"><span class="w">            </span><span class="n">inner_context</span><span class="p">:</span><span class="w"> </span><span class="nc">Context</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">inner_context</span><span class="p">.</span><span class="n">state</span><span class="p">().</span><span class="n">clone</span><span class="p">()),</span>
</span><span id="__span-1-19"><span class="w">            </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">vec</span><span class="o">!</span><span class="p">[</span><span class="n">item</span><span class="p">],</span>
</span><span id="__span-1-20"><span class="w">            </span><span class="n">results</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="p">::</span><span class="n">new</span><span class="p">(),</span>
</span><span id="__span-1-21"><span class="w">        </span><span class="p">})</span>
</span><span id="__span-1-22"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-23">
</span><span id="__span-1-24"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">update_with_results</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-25"><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
</span><span id="__span-1-26"><span class="w">        </span><span class="nb">Ok</span><span class="p">(())</span>
</span><span id="__span-1-27"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-28"><span class="p">}</span>
</span></code></pre></div>
<h2 id="batchnode">BatchNode<a class="headerlink" href="#batchnode" title="Permanent link">&para;</a></h2>
<p>The <code>BatchNode</code> trait extends the standard <code>Node</code> trait with batch processing capabilities:</p>
<div class="language-rust highlight"><pre><span></span><code><span id="__span-2-1"><span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">BatchNode</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">:</span><span class="w"> </span><span class="nc">Node</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-2"><span class="w">    </span><span class="sd">/// Process a batch of items concurrently</span>
</span><span id="__span-2-3"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">process_batch</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="bp">Self</span><span class="p">::</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="n">concurrency</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span>
</span><span id="__span-2-4"><span class="w">    </span><span class="k">where</span>
</span><span id="__span-2-5"><span class="w">        </span><span class="bp">Self</span><span class="p">::</span><span class="n">Context</span><span class="p">:</span><span class="w"> </span><span class="nc">BatchContext</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span>
</span><span id="__span-2-6"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-2-7"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">get_batch_items</span><span class="p">()</span><span class="o">?</span><span class="p">;</span>
</span><span id="__span-2-8"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">processor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BatchProcessor</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">concurrency</span><span class="p">);</span>
</span><span id="__span-2-9">
</span><span id="__span-2-10"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">processor</span><span class="p">.</span><span class="n">process_items</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">item</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-11"><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">item_ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">create_item_context</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
</span><span id="__span-2-12"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">exec</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">item_ctx</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
</span><span id="__span-2-13"><span class="w">            </span><span class="nb">Ok</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="__span-2-14"><span class="w">        </span><span class="p">})</span><span class="o">?</span><span class="p">;</span>
</span><span id="__span-2-15">
</span><span id="__span-2-16"><span class="w">        </span><span class="n">ctx</span><span class="p">.</span><span class="n">update_with_results</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
</span><span id="__span-2-17"><span class="w">        </span><span class="nb">Ok</span><span class="p">(())</span>
</span><span id="__span-2-18"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-19"><span class="p">}</span>
</span></code></pre></div>
<h2 id="batchprocessor">BatchProcessor<a class="headerlink" href="#batchprocessor" title="Permanent link">&para;</a></h2>
<p>The <code>BatchProcessor</code> handles the actual parallel execution of items:</p>
<div class="language-rust highlight"><pre><span></span><code><span id="__span-3-1"><span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">BatchProcessor</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><span class="w">    </span><span class="n">concurrency_limit</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">,</span>
</span><span id="__span-3-3"><span class="p">}</span>
</span><span id="__span-3-4">
</span><span id="__span-3-5"><span class="k">impl</span><span class="w"> </span><span class="n">BatchProcessor</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-6"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span><span class="n">concurrency_limit</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-7"><span class="w">        </span><span class="bp">Self</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">concurrency_limit</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-3-8"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-9">
</span><span id="__span-3-10"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">process_items</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">processor</span><span class="p">:</span><span class="w"> </span><span class="nc">F</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span>
</span><span id="__span-3-11"><span class="w">    </span><span class="k">where</span>
</span><span id="__span-3-12"><span class="w">        </span><span class="n">F</span><span class="p">:</span><span class="w"> </span><span class="nb">Fn</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Send</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Sync</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">&#39;</span><span class="nb">static</span><span class="p">,</span>
</span><span id="__span-3-13"><span class="w">        </span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="nb">Send</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">&#39;</span><span class="nb">static</span><span class="p">,</span>
</span><span id="__span-3-14"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-3-15"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">semaphore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arc</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">Semaphore</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">concurrency_limit</span><span class="p">));</span>
</span><span id="__span-3-16"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">processor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arc</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">processor</span><span class="p">);</span>
</span><span id="__span-3-17">
</span><span id="__span-3-18"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">handles</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span>
</span><span id="__span-3-19"><span class="w">            </span><span class="p">.</span><span class="n">into_iter</span><span class="p">()</span>
</span><span id="__span-3-20"><span class="w">            </span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">item</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-21"><span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">semaphore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arc</span><span class="p">::</span><span class="n">clone</span><span class="p">(</span><span class="o">&amp;</span><span class="n">semaphore</span><span class="p">);</span>
</span><span id="__span-3-22"><span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">processor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arc</span><span class="p">::</span><span class="n">clone</span><span class="p">(</span><span class="o">&amp;</span><span class="n">processor</span><span class="p">);</span>
</span><span id="__span-3-23">
</span><span id="__span-3-24"><span class="w">                </span><span class="n">thread</span><span class="p">::</span><span class="n">spawn</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-25"><span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">_permit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">semaphore</span><span class="p">.</span><span class="n">acquire</span><span class="p">();</span>
</span><span id="__span-3-26"><span class="w">                    </span><span class="n">processor</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="__span-3-27"><span class="w">                </span><span class="p">})</span>
</span><span id="__span-3-28"><span class="w">            </span><span class="p">})</span>
</span><span id="__span-3-29"><span class="w">            </span><span class="p">.</span><span class="n">collect</span><span class="p">();</span>
</span><span id="__span-3-30">
</span><span id="__span-3-31"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">handles</span>
</span><span id="__span-3-32"><span class="w">            </span><span class="p">.</span><span class="n">into_iter</span><span class="p">()</span>
</span><span id="__span-3-33"><span class="w">            </span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">handle</span><span class="o">|</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">handle</span><span class="p">.</span><span class="n">join</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-34"><span class="w">                </span><span class="nb">Ok</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">result</span><span class="p">,</span>
</span><span id="__span-3-35"><span class="w">                </span><span class="nb">Err</span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="n">FloxideError</span><span class="p">::</span><span class="n">ThreadPanicked</span><span class="p">),</span>
</span><span id="__span-3-36"><span class="w">            </span><span class="p">})</span>
</span><span id="__span-3-37"><span class="w">            </span><span class="p">.</span><span class="n">collect</span><span class="p">();</span>
</span><span id="__span-3-38">
</span><span id="__span-3-39"><span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="__span-3-40"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-41"><span class="p">}</span>
</span></code></pre></div>
<h2 id="batchflow">BatchFlow<a class="headerlink" href="#batchflow" title="Permanent link">&para;</a></h2>
<p>The <code>BatchFlow</code> provides a simplified API for batch processing workflows:</p>
<div class="language-rust highlight"><pre><span></span><code><span id="__span-4-1"><span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">BatchFlow</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span>
</span><span id="__span-4-2"><span class="k">where</span>
</span><span id="__span-4-3"><span class="w">    </span><span class="n">N</span><span class="p">:</span><span class="w"> </span><span class="nc">BatchNode</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span>
</span><span id="__span-4-4"><span class="p">{</span>
</span><span id="__span-4-5"><span class="w">    </span><span class="n">node</span><span class="p">:</span><span class="w"> </span><span class="nc">N</span><span class="p">,</span>
</span><span id="__span-4-6"><span class="w">    </span><span class="n">concurrency</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">,</span>
</span><span id="__span-4-7"><span class="w">    </span><span class="n">_phantom</span><span class="p">:</span><span class="w"> </span><span class="nc">PhantomData</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span>
</span><span id="__span-4-8"><span class="p">}</span>
</span><span id="__span-4-9">
</span><span id="__span-4-10"><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="w"> </span><span class="n">BatchFlow</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span>
</span><span id="__span-4-11"><span class="k">where</span>
</span><span id="__span-4-12"><span class="w">    </span><span class="n">N</span><span class="p">:</span><span class="w"> </span><span class="nc">BatchNode</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span>
</span><span id="__span-4-13"><span class="p">{</span>
</span><span id="__span-4-14"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span><span class="n">node</span><span class="p">:</span><span class="w"> </span><span class="nc">N</span><span class="p">,</span><span class="w"> </span><span class="n">concurrency</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-15"><span class="w">        </span><span class="bp">Self</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-16"><span class="w">            </span><span class="n">node</span><span class="p">,</span>
</span><span id="__span-4-17"><span class="w">            </span><span class="n">concurrency</span><span class="p">,</span>
</span><span id="__span-4-18"><span class="w">            </span><span class="n">_phantom</span><span class="p">:</span><span class="w"> </span><span class="nc">PhantomData</span><span class="p">,</span>
</span><span id="__span-4-19"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-4-20"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-21">
</span><span id="__span-4-22"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">execute</span><span class="o">&lt;</span><span class="n">C</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">context</span><span class="p">:</span><span class="w"> </span><span class="nc">C</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">FloxideError</span><span class="o">&gt;</span>
</span><span id="__span-4-23"><span class="w">    </span><span class="k">where</span>
</span><span id="__span-4-24"><span class="w">        </span><span class="n">C</span><span class="p">:</span><span class="w"> </span><span class="nc">BatchContext</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span>
</span><span id="__span-4-25"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-4-26"><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="n">process_batch</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">concurrency</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
</span><span id="__span-4-27"><span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</span><span id="__span-4-28"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-29"><span class="p">}</span>
</span></code></pre></div>
<h2 id="usage-example">Usage Example<a class="headerlink" href="#usage-example" title="Permanent link">&para;</a></h2>
<p>Here's an example of using the batch processing capabilities:</p>
<div class="language-rust highlight"><pre><span></span><code><span id="__span-5-1"><span class="c1">// Define a state type</span>
</span><span id="__span-5-2"><span class="k">struct</span><span class="w"> </span><span class="nc">MyState</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-3"><span class="w">    </span><span class="n">processed_count</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">,</span>
</span><span id="__span-5-4"><span class="p">}</span>
</span><span id="__span-5-5">
</span><span id="__span-5-6"><span class="c1">// Define an item type</span>
</span><span id="__span-5-7"><span class="k">struct</span><span class="w"> </span><span class="nc">MyItem</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-8"><span class="w">    </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">,</span>
</span><span id="__span-5-9"><span class="w">    </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
</span><span id="__span-5-10"><span class="p">}</span>
</span><span id="__span-5-11">
</span><span id="__span-5-12"><span class="c1">// Create a batch context</span>
</span><span id="__span-5-13"><span class="kd">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">processed_count</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-5-14"><span class="kd">let</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span>
</span><span id="__span-5-15"><span class="w">    </span><span class="n">MyItem</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;item1&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">()</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-5-16"><span class="w">    </span><span class="n">MyItem</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;item2&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">()</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-5-17"><span class="w">    </span><span class="n">MyItem</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;item3&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">()</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-5-18"><span class="p">];</span>
</span><span id="__span-5-19"><span class="kd">let</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleBatchContext</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>
</span><span id="__span-5-20">
</span><span id="__span-5-21"><span class="c1">// Create a batch node</span>
</span><span id="__span-5-22"><span class="k">struct</span><span class="w"> </span><span class="nc">MyBatchNode</span><span class="p">;</span>
</span><span id="__span-5-23">
</span><span id="__span-5-24"><span class="k">impl</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyBatchNode</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-25"><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nc">Context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SimpleBatchContext</span><span class="o">&lt;</span><span class="n">MyState</span><span class="p">,</span><span class="w"> </span><span class="n">MyItem</span><span class="o">&gt;</span><span class="p">;</span>
</span><span id="__span-5-26">
</span><span id="__span-5-27"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">exec</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="bp">Self</span><span class="p">::</span><span class="n">Context</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">NodeResult</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-28"><span class="w">        </span><span class="c1">// Process a single item</span>
</span><span id="__span-5-29"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">.</span><span class="n">get_batch_items</span><span class="p">()</span><span class="o">?</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span><span id="__span-5-30"><span class="w">        </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Processing item {}: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>
</span><span id="__span-5-31"><span class="w">        </span><span class="n">ctx</span><span class="p">.</span><span class="n">inner_context</span><span class="p">.</span><span class="n">state_mut</span><span class="p">().</span><span class="n">processed_count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-5-32"><span class="w">        </span><span class="nb">Ok</span><span class="p">(())</span>
</span><span id="__span-5-33"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-34"><span class="p">}</span>
</span><span id="__span-5-35">
</span><span id="__span-5-36"><span class="k">impl</span><span class="w"> </span><span class="n">BatchNode</span><span class="o">&lt;</span><span class="n">MyItem</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyBatchNode</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-5-37">
</span><span id="__span-5-38"><span class="c1">// Create and execute a batch flow</span>
</span><span id="__span-5-39"><span class="kd">let</span><span class="w"> </span><span class="n">batch_flow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BatchFlow</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">MyBatchNode</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
</span><span id="__span-5-40"><span class="kd">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batch_flow</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
</span></code></pre></div>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>The batch processing implementation in the Floxide framework provides a powerful and flexible approach to parallel execution of workflows. By leveraging Rust's concurrency features and the framework's core abstractions, it enables efficient processing of large datasets while maintaining type safety and proper error handling.</p>
<p>For more detailed information on the batch processing implementation, refer to the <a href="../../adrs/0007-batch-processing-implementation/">Batch Processing Implementation ADR</a>.</p>
</section>

            </main>
        </div>
        <hr><footer>
    <div class="terminal-mkdocs-footer-grid">
        <div id="terminal-mkdocs-footer-copyright-info">
             Site built with <a href="http://www.mkdocs.org">MkDocs</a> and <a href="https://github.com/ntno/mkdocs-terminal">Terminal for MkDocs</a>.
        </div>
    </div>
</footer>
    </div>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="alertdialog" aria-modal="true" aria-labelledby="searchModalLabel">
    <div class="modal-dialog modal-lg" role="search">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="searchModalLabel">Search</h5>
                <button type="button" class="close btn btn-default btn-ghost" data-dismiss="modal"><span aria-hidden="true">x</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p id="searchInputLabel">Type to start searching</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" aria-labelledby="searchInputLabel" placeholder="" id="mkdocs-search-query" title="Please enter search terms here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No document matches found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    
    
</body>

</html>